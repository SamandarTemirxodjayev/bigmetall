(()=>{var t={53:(t,e,a)=>{const s=a(344),{generateUsername:i}=a(414),n=a(96),l=a(185),r=a(641),o=a(245),u=a(901),d=a(847),c=a(877),y=(a(337),a(272)),g=a(404),$=a(329),m=a(465),p=a(566),h=a(206),{formatTime:_}=a(406),j=a(986);a(142).config();const w=a(147);e.index=async(t,e)=>{e.json({message:"Welcome to the API!"})},e.token=(t,e)=>{try{const t=s.sign({data:123},process.env.ACCESS_TOKEN_SECRET,{expiresIn:"12h"});return e.json({token:t})}catch(t){return e.status(500).json({message:"Error when find user"})}},e.check=async(t,e)=>{e.json({message:t.userId})},e.register=async(t,e)=>{try{const a=i(t.body.surname,3,15),s=await n.hash("admin",13),l=new u({login:a,password:s,name:t.body.name,user_level:t.body.user_level,surname:t.body.surname});return await l.save(),e.status(201).json({status:"success",message:"User registered successfully",data:l})}catch(t){return e.status(500).json(t)}},e.loginPatch=async(t,e)=>{try{if(await u.findOne({login:t.body.username}))return e.status(400).json({error:"invalid"});const a=await n.hash(t.body.password,13),s=await u.findById(t.userId);return s.login=t.body.username,s.password=a,await s.save(),e.json({status:"success"})}catch(t){return e.status(500).json(t)}},e.login=async(t,e)=>{try{const a=await u.findOne({login:t.body.login});if(!a)return e.status(400).json({message:"Foydalanuvchi Topilmadi"});if(!await n.compare(t.body.password,a.password))return e.status(400).json({message:"Parol Xato"});const i=s.sign({userId:a._id},process.env.ACCESS_TOKEN_SECRET,{expiresIn:"12h"});return e.json({token:i})}catch(t){return e.status(500).json(t)}},e.userGetInfo=async(t,e)=>{try{const a=await u.findById(t.userId);return e.json({user:a})}catch(t){return e.status(500).json(t)}},e.usersGetAll=async(t,e)=>{try{const t=await u.find().sort({_id:-1});return e.json(t)}catch(t){return e.status(500).json(t)}},e.userDelete=async(t,e)=>{try{const a=await u.findById(t.params.id);return a?(await a.deleteOne(),e.json({message:"User deleted"})):e.status(404).json({message:"User not found"})}catch(t){return e.status(500).json(t)}},e.userPatch=async(t,e)=>{try{const a=await u.findById(t.params.id);return a?(a.name=t.body.name,a.surname=t.body.surname,a.user_level=t.body.user_level,await a.save(),e.json({user:a})):e.status(404).json({message:"User not found"})}catch(t){return e.status(500).json(t)}},e.harajatPut=async(t,e)=>{try{const a=new d({name:t.body.name,amount:t.body.amount,userId:t.userId,sklad:t.body.sklad});return await a.save(),e.json({harajat:a})}catch(t){return e.status(500).json(t)}},e.harajatGet=async(t,e)=>{try{const a=await d.find().sort({_id:-1}).limit(t.query.limit).populate("sklad");return e.json(a)}catch(t){return e.status(500).json(t)}},e.harajatPost=async(t,e)=>{try{const{date:a}=t.body,s=await d.find({date:a});return e.json(s)}catch(t){return e.status(500).json(t)}},e.harajatDelete=async(t,e)=>{try{const a=await d.findById(t.params.id);if(!a)return e.status(404).json({message:"Harajat not found"});const s=new c({user:t.userId,deletedFrom:{name:a.name,amount:a.amount}});return await s.save(),await a.deleteOne(),e.json({message:"Deleted successfully"})}catch(t){return e.status(500).json(t)}},e.harajatPatch=async(t,e)=>{try{const a=await d.findById(t.params.id);return a?(a.name=t.body.name,a.amount=t.body.amount,a.sklad=new l.Types.ObjectId(t.body.sklad),await a.save(),e.json({harajat:a})):e.status(404).json({message:"Harajat not found"})}catch(t){return e.status(500).json(t)}},e.harajatFinder=async(t,e)=>{try{const a=new RegExp(t.body.search,"i"),s=new Date;s.setDate(s.getDay()-31);const i={name:a,date:{$gte:t.body.startDate||s,$lte:t.body.endDate||new Date}};t.body.sklad&&(i.sklad=t.body.sklad);const n=await d.find(i).sort({_id:-1}).limit(t.query.limit).populate("sklad");return e.json(n)}catch(t){return e.status(500).json({error:"An error occurred while searching for Harajat."})}},e.harajatExcel=async(t,e)=>{try{const t=(new Date).getFullYear(),a=(new Date).getMonth()+1,s={font:{bold:!0},alignment:{horizontal:"center",vertical:"middle"},border:{top:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"}}},i=new r.Workbook;let n=await y.find({active:!0});return await Promise.all(n.map((async e=>{let n=i.addWorksheet(`${e.name}`);const l=new Date(`${t}-01-01T00:00:00.000Z`),r=new Date(`${t}-12-31T23:59:59.999Z`);let o=await d.find({date:{$gte:l,$lte:r},sklad:e._id}).populate("sklad");n.getCell(1,13).value="ID",n.getCell(1,14).value="Harajat Nomi",n.getCell(1,15).value="Summasi",n.getCell(1,16).value="Ombor",n.getCell(1,17).value="Sanasi va Vaqti";let u=0;o.forEach(((t,e)=>{n.getCell(e+2,13).value=e+1,n.getCell(e+2,14).value=t.name||"",n.getCell(e+2,15).value=`${t.amount.toLocaleString("en-US").replace(/,/g," ")} so'm`,n.getCell(e+2,16).value=t.sklad.name,n.getCell(e+2,17).value=_(t.date),u+=t.amount})),n.getCell(o.length+2,14).value="Umumiy Harajat Summasi",n.getCell(o.length+2,15).value=`${u.toLocaleString("en-US").replace(/,/g," ")} so'm`,n.eachRow((t=>{t.eachCell((t=>{t.style=s}))})),n.columns.forEach((t=>{let e=0;t.eachCell({includeEmpty:!0},(t=>{const a=t.value?t.value.toString().length:10;a>e&&(e=a+3)})),t.width=e<10?10:e})),o=await d.find({date:{$gte:new Date(`${t}-${a.toString().padStart(2,"0")}-01T00:00:00.000Z`),$lte:new Date(`${t}-${a.toString().padStart(2,"0")}-${new Date(t,a,0).getDate()}T23:59:59.999Z`)},sklad:e._id}).populate("sklad"),n.getCell(1,7).value="ID",n.getCell(1,8).value="Harajat Nomi",n.getCell(1,9).value="Summasi",n.getCell(1,10).value="Ombor",n.getCell(1,11).value="Sanasi va Vaqti",u=0,o.forEach(((t,e)=>{n.getCell(e+2,7).value=e+1,n.getCell(e+2,8).value=t.name||"",n.getCell(e+2,9).value=`${t.amount.toLocaleString("en-US").replace(/,/g," ")} so'm`,n.getCell(e+2,10).value=t.sklad.name,n.getCell(e+2,11).value=_(t.date),u+=t.amount})),n.getCell(o.length+2,8).value="Umumiy Harajat Summasi",n.getCell(o.length+2,9).value=`${u.toLocaleString("en-US").replace(/,/g," ")} so'm`,n.eachRow((t=>{t.eachCell((t=>{t.style=s}))})),n.columns.forEach((t=>{let e=0;t.eachCell({includeEmpty:!0},(t=>{const a=t.value?t.value.toString().length:10;a>e&&(e=a+3)})),t.width=e<10?10:e}));const c=new Date;c.setDate(c.getDate()-7),o=await d.find({date:{$gte:c,$lte:new Date},sklad:e._id}).populate("sklad"),n.getCell(1,1).value="ID",n.getCell(1,2).value="Harajat Nomi",n.getCell(1,3).value="Summasi",n.getCell(1,4).value="Ombor",n.getCell(1,5).value="Sanasi va Vaqti",u=0,o.forEach(((t,e)=>{n.getCell(e+2,1).value=e+1,n.getCell(e+2,2).value=t.name||"",n.getCell(e+2,3).value=`${t.amount.toLocaleString("en-US").replace(/,/g," ")} so'm`,n.getCell(e+2,4).value=t.sklad.name,n.getCell(e+2,5).value=_(t.date),u+=t.amount})),n.getCell(o.length+2,2).value="Umumiy Harajat Summasi",n.getCell(o.length+2,3).value=`${u.toLocaleString("en-US").replace(/,/g," ")} so'm`,n.eachRow((t=>{t.eachCell((t=>{t.style=s}))})),n.columns.forEach((t=>{let e=0;t.eachCell({includeEmpty:!0},(t=>{const a=t.value?t.value.toString().length:10;a>e&&(e=a+3)})),t.width=e<10?10:e}))}))),await i.xlsx.writeFile("./docs/SKLAD.xlsx"),e.download("./docs/SKLAD.xlsx")}catch(t){return e.status(500).json(t)}},e.harajatExcelByDate=async(t,e)=>{try{const a={font:{bold:!0},alignment:{horizontal:"center",vertical:"middle"},border:{top:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"}}},s=new Date(t.query.startDate||new Date(`${(new Date).getFullYear()}-01-01T00:00:00.000Z`)),i=new Date(t.query.endDate||new Date),n=`${s.getDate()}.${(s.getMonth()+1).toString().padStart(2,"0")}.${s.getFullYear()}`,l=`${i.getDate()}.${(i.getMonth()+1).toString().padStart(2,"0")}.${i.getFullYear()}`,o=new r.Workbook,u=o.addWorksheet(`${n} - ${l}`);let c={date:{$gte:s,$lte:i}};t.query.sklad&&(c.sklad=t.query.sklad);const y=await d.find(c).populate("sklad");u.getCell(1,1).value="ID",u.getCell(1,2).value="Harajat Nomi",u.getCell(1,3).value="Summasi",u.getCell(1,4).value="Ombor",u.getCell(1,5).value="Sanasi va Vaqti";let g=0;return y.forEach(((t,e)=>{u.getCell(e+2,1).value=e+1,u.getCell(e+2,2).value=t.name||"",u.getCell(e+2,3).value=`${t.amount.toLocaleString("en-US").replace(/,/g," ")} so'm`,u.getCell(e+2,4).value=t.sklad.name,u.getCell(e+2,5).value=_(t.date),g+=t.amount})),u.getCell(y.length+2,2).value="Umumiy Harajat Summasi",u.getCell(y.length+2,3).value=`${g.toLocaleString("en-US").replace(/,/g," ")} so'm`,u.eachRow((t=>{t.eachCell((t=>{t.style=a}))})),u.columns.forEach((t=>{let e=0;t.eachCell({includeEmpty:!0},(t=>{const a=t.value?t.value.toString().length:10;a>e&&(e=a+3)})),t.width=e<10?10:e})),await o.xlsx.writeFile("./docs/SKLAD.xlsx"),e.download("./docs/SKLAD.xlsx")}catch(t){return e.status(500).json(t)}},e.harajatYearGet=async(t,e)=>{try{const t=(new Date).getFullYear(),a=await d.aggregate([{$match:{date:{$gte:new Date(`${t}-01-01T00:00:00.000Z`),$lte:new Date(`${t+1}-01-01T00:00:00.000Z`)}}},{$group:{_id:null,totalAmount:{$sum:"$amount"}}},{$project:{_id:0,totalAmount:1}}]),s=a.length>0?a[0].totalAmount:0;return e.json({totalAmount:s})}catch(t){return e.status(500).json(t)}},e.harajatYearGetGraph=async(t,e)=>{try{const t=(new Date).getFullYear(),a=await d.aggregate([{$match:{date:{$gte:new Date(`${t}-01-01T00:00:00.000Z`),$lte:new Date(`${t+1}-01-01T00:00:00.000Z`)}}},{$group:{_id:{year:{$year:"$date"},month:{$month:"$date"},day:{$dayOfMonth:"$date"}},totalAmount:{$sum:"$amount"}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]);return e.json(a)}catch(t){return e.status(500).json(t)}},e.skladGet=async(t,e)=>{try{const t=await y.find({active:!0});return e.json(t)}catch(t){return e.status(500).json(t)}},e.skladPatchPrice=async(t,e)=>{try{const t=await y.find({active:!0}).lean();return await Promise.all(t.map((async t=>{const e=await g.aggregate([{$match:{saled:!1,sklad:t._id}},{$group:{_id:null,totalPrice:{$sum:{$cond:{if:{$eq:["$name","List"]},then:{$multiply:["$price",{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:["$price","$uzunligi"]}}}}}},{$project:{_id:0,totalAmount:"$totalPrice"}}]),a=e.length>0?e[0].totalAmount:0;t.totalAmount=a}))),e.json(t)}catch(t){return e.status(500).json(t)}},e.skladProductsPost=async(t,e)=>{try{const a=await g.aggregate([{$match:{name:t.body.name,category:t.body.category,qalinligi:t.body.qalinligi,qalinligi_ortasi:t.body.qalinligi_ortasi,holati:t.body.holati,sklad:new l.Types.ObjectId(t.body.sklad),saled:!1}},{$group:{_id:{name:"$name",qalinligi:"$qalinligi",qalinligi_ortasi:"$qalinligi_ortasi",category:"$category",holati:"$holati",olchamlari:"$olchamlari",sklad:"$sklad",uzunligi:"$uzunligi",uzunligi_x:"$uzunligi_x",uzunligi_y:"$uzunligi_y",price:"$price",saledPrice:"$saledPrice",cut:"$cut"},totalQuantity:{$sum:"$quantity"},totalUzunligi:{$sum:{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[1,{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:[1,"$uzunligi"]}}}}}},{$project:{_id:0,name:"$_id.name",qalinligi:"$_id.qalinligi",qalinligi_ortasi:"$_id.qalinligi_ortasi",category:"$_id.category",holati:"$_id.holati",uzunligi:"$_id.uzunligi",uzunligi_x:"$_id.uzunligi_x",uzunligi_y:"$_id.uzunligi_y",sklad:"$_id.sklad",price:"$_id.price",olchamlari:"$_id.olchamlari",saledPrice:"$_id.saledPrice",quantity:"$totalQuantity",totalUzunligi:"$totalUzunligi",cut:"$_id.cut"}},{$sort:{category:1,qalinligi:1,qalinligi_ortasi:1,uzunligi:-1}}]);return e.json(a)}catch(t){return e.status(500).json(t)}},e.skladsGet=async(t,e)=>{try{const t=await y.find();return e.json(t)}catch(t){return e.status(500).json(t)}},e.skladPut=async(t,e)=>{try{const a=new y({name:t.body.name});return await a.save(),e.json(a)}catch(t){return e.status(500).json(t)}},e.skladDelete=async(t,e)=>{try{const a=await y.findById(t.params.id);return a?(a.active=!1,await a.save(),e.json({message:"Deleted successfully"})):e.status(404).json({message:"Sklad not found"})}catch(t){return e.status(500).json(t)}},e.skladPatch=async(t,e)=>{try{const a=await y.findById(t.params.id);return a?(a.name=t.body.name,await a.save(),e.json({sklad:a})):e.status(404).json({message:"Sklad not found"})}catch(t){return e.status(500).json(t)}},e.skladFinder=async(t,e)=>{try{const a=new RegExp(t.body.search,"i"),s=await y.find({name:a}).sort({_id:-1});return e.json(s)}catch(t){return e.status(500).json(t)}},e.productsGet=async(t,e)=>{try{const a=await g.aggregate([{$match:{sklad:new l.Types.ObjectId(t.params.id),saled:!1}},{$group:{_id:{name:"$name",qalinligi:"$qalinligi",qalinligi_ortasi:"$qalinligi_ortasi",category:"$category",holati:"$holati",olchamlari:"$olchamlari",sklad:"$sklad"},totalQuantity:{$sum:"$quantity"},totalUzunligi:{$sum:{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[1,{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:[1,"$uzunligi"]}}}},minUzunligi:{$min:"$uzunligi"},maxUzunligi:{$max:"$uzunligi"}}},{$project:{_id:0,name:"$_id.name",qalinligi:"$_id.qalinligi",qalinligi_ortasi:"$_id.qalinligi_ortasi",category:"$_id.category",holati:"$_id.holati",uzunligi:"$_id.uzunligi",uzunligi_x:"$_id.uzunligi_x",uzunligi_y:"$_id.uzunligi_y",sklad:"$_id.sklad",price:"$_id.price",olchamlari:"$_id.olchamlari",saledPrice:"$_id.saledPrice",quantity:"$totalQuantity",totalUzunligi:"$totalUzunligi",minUzunligi:"$minUzunligi",maxUzunligi:"$maxUzunligi",cut:"$_id.cut"}},{$sort:{category:1,qalinligi:1,qalinligi_ortasi:1,quantity:1}}]);return e.json(a)}catch(t){return e.status(500).json(t)}},e.productsPatch=async(t,e)=>{try{const a=await g.findById(t.params.id).populate("saledClient");return a?e.json(a):e.status(404).json({message:"Product not found"})}catch(t){return e.status(500).json(t)}},e.productsGetAll=async(t,e)=>{try{const t=await g.aggregate([{$match:{saled:!1}},{$group:{_id:{name:"$name",qalinligi:"$qalinligi",qalinligi_ortasi:"$qalinligi_ortasi",category:"$category",holati:"$holati",uzunligi:"$uzunligi",uzunligi_x:"$uzunligi_x",olchamlari:"$olchamlari",uzunligi_y:"$uzunligi_y",sklad:"$sklad",price:"$price",saledPrice:"$saledPrice",cut:"$cut"},totalQuantity:{$sum:"$quantity"}}},{$project:{name:"$_id.name",qalinligi:"$_id.qalinligi",qalinligi_ortasi:"$_id.qalinligi_ortasi",category:"$_id.category",holati:"$_id.holati",uzunligi:"$_id.uzunligi",uzunligi_x:"$_id.uzunligi_x",uzunligi_y:"$_id.uzunligi_y",sklad:"$_id.sklad",price:"$_id.price",olchamlari:"$_id.olchamlari",saledPrice:"$_id.saledPrice",quantity:"$totalQuantity",cut:"$_id.cut"}}]);return e.json(t)}catch(t){return e.status(500).json(t)}},e.productsPut=async(t,e)=>{try{for(let a=0;a<t.body.quantity;a+=1)try{new g({userId:t.userId,name:t.body.name,sellerId:t.body.sellerId,qalinligi:t.body.qalinligi,qalinligi_ortasi:t.body.qalinligiOrtasi,category:t.body.category,olchamlari:t.body.olchamlari,holati:t.body.holati,uzunligi:t.body.uzunligi,uzunligi_x:t.body.uzunligi_x,uzunligi_y:t.body.uzunligi_y,quantity:1,sklad:t.body.sklad,price:t.body.price,saledPrice:t.body.saledPrice,isDebt:t.body.isDebt}).save()}catch(t){return e.status(500).json(t)}return e.json({saved:!0})}catch(t){return e.status(500).json(t)}},e.productsGetClients=async(t,e)=>{try{const a=await m.aggregate([{$match:{clientId:new l.Types.ObjectId(t.params.id)}},{$lookup:{from:"clients",localField:"clientId",foreignField:"_id",as:"clientId"}},{$unwind:"$clientId"},{$sort:{"date.year":-1,"date.month":-1,"date.day":-1}},{$limit:50}]),s=Array.from(new Set(a.map((t=>{const{day:e,month:a,year:s}=t.date;return`${e}-${a}-${s}`}))));return e.json({dates:s,products:a})}catch(t){return e.status(500).json(t)}},e.productsGetClientsByDate=async(t,e)=>{try{const a=await m.find({clientId:new l.Types.ObjectId(t.params.id),date:{day:t.body.date.day,month:t.body.date.month,year:t.body.date.year}}).populate("clientId");return e.json(a)}catch(t){return e.status(500).json(t)}},e.productsGetSaled=async(t,e)=>{try{const a=await g.find({saled:!0,saledClient:new l.Types.ObjectId(t.params.id),saledType:"Qarz"});return e.status(200).json(a)}catch(t){return e.status(500).json(t)}},e.getProductId=async(t,e)=>{try{const a=await g.findOne({...t.body,saled:!1});return e.json(a)}catch(t){return e.status(500).json(t)}},e.productPut=async(t,e)=>{try{const a=await g.findOne(t.body.product);if(!a)return e.status(404).json({message:"Product not found"});const s={...{...a.toObject()}};delete s._id,delete s.date;for(let a=0;a<t.body.quantity;a+=1)try{const e=await g.findOne(s);e.saledPrice=t.body.saledPrice,await e.save()}catch(t){return e.status(500).json(t)}return e.json({saved:!0})}catch(t){return e.status(500).json(t)}},e.getProductsWithDebts=async(t,e)=>{try{const a=await p.aggregate([{$match:{clientId:new l.Types.ObjectId(t.params.id),active:!0}},{$lookup:{from:"clients",localField:"clientId",foreignField:"_id",as:"clientId"}},{$unwind:"$clientId"},{$sort:{"date.year":-1,"date.month":-1,"date.day":-1}},{$limit:50}]),s=Array.from(new Set(a.map((t=>{const{day:e,month:a,year:s}=t.date;return`${e}-${a}-${s}`}))));return e.json({dates:s,products:a})}catch(t){return e.status(500).json(t)}},e.postProductsInfo=async(t,e)=>{try{const a=await m.findById(t.params.id).populate("clientId");return e.json(a)}catch(t){return e.status(500).json(t)}},e.postProductsDebt=async(t,e)=>{try{const a=await p.findById(t.params.id).populate("clientId");return e.json(a)}catch(t){return e.status(500).json(t)}},e.putProductsDebt=async(t,e)=>{try{if(t.body.amount<=0)return e.status(400).json({message:"Amount must be greater than 0"});const a=await p.findOne({_id:t.params.id}).populate("clientId");if(!a)return e.status(404).json({message:"Product not found"});let s=new Date;if(s=o(s).format(),a.historyAmount.push({clientSaved:t.body.clientSaved,payedType:t.body.payedType,amount:t.body.amount,date:s}),a.payedAmount+=t.body.amount,a.payedAmount===a.allAmount){const t=new m({clientId:a.clientId,sellerId:a.sellerId,products:a.products,allAmount:a.allAmount,type:"Qarz(To'langan)",debt:a});await t.save(),a.active=!1,await a.save()}return await a.save(),e.json({saved:!0})}catch(t){return e.status(500).json(t)}},e.productsGetSeller=async(t,e)=>{try{const a=await g.aggregate([{$match:{saled:!1,sellerId:new l.Types.ObjectId(t.params.id)}},{$group:{_id:{name:"$name",sellerId:"$sellerId",qalinligi:"$qalinligi",qalinligi_ortasi:"$qalinligi_ortasi",category:"$category",holati:"$holati",uzunligi:"$uzunligi",uzunligi_x:"$uzunligi_x",olchamlari:"$olchamlari",uzunligi_y:"$uzunligi_y",sklad:"$sklad",cut:"$cut",price:"$price",saledPrice:"$saledPrice"},totalQuantity:{$sum:"$quantity"}}},{$project:{name:"$_id.name",sellerId:"$_id.sellerId",qalinligi:"$_id.qalinligi",qalinligi_ortasi:"$_id.qalinligi_ortasi",category:"$_id.category",holati:"$_id.holati",uzunligi:"$_id.uzunligi",uzunligi_x:"$_id.uzunligi_x",uzunligi_y:"$_id.uzunligi_y",sklad:"$_id.sklad",cut:"$_id.cut",price:"$_id.price",olchamlari:"$_id.olchamlari",saledPrice:"$_id.saledPrice",quantity:"$totalQuantity",date:"$_id.date"}},{$limit:50}]);return await g.populate(a,{path:"sellerId"}),await g.populate(a,{path:"sklad"}),e.status(200).json(a)}catch(t){return e.status(500).json(t)}},e.productsPostSeller=async(t,e)=>{try{const a=new Date;a.setDate(a.getDay()-31);const s=t.body.startDate||a,i=t.body.endDate||new Date,n=await g.find({sellerId:new l.Types.ObjectId(t.params.id),date:{$gte:s,$lte:i}});return e.status(200).json(n)}catch(t){return e.status(500).json(t)}},e.getProductsWithDebtsPrice=async(t,e)=>{try{const t=await p.aggregate([{$match:{active:!0}},{$project:{totalDebt:{$subtract:["$allAmount","$payedAmount"]}}},{$group:{_id:null,totalAmount:{$sum:"$totalDebt"}}}]),a=t.length>0?t[0].totalAmount:0;return e.status(200).json({result:a})}catch(t){return e.status(500).json(t)}},e.productsFinder=async(t,e)=>{try{const a=new RegExp(t.body.category,"i"),s=new RegExp(t.body.olchamlari,"i"),i={name:t.body.name,saled:!1,category:a,olchamlari:s};t.body.qalinligi&&(i.qalinligi=parseFloat(t.body.qalinligi)),t.body.qalinligi_ortasi&&(i.qalinligi_ortasi=parseFloat(t.body.qalinligi_ortasi)),t.body.holati&&(i.holati=t.body.holati);const n=await g.aggregate([{$match:i},{$group:{_id:{name:"$name",qalinligi:"$qalinligi",qalinligi_ortasi:"$qalinligi_ortasi",category:"$category",holati:"$holati",olchamlari:"$olchamlari",sklad:"$sklad"},totalQuantity:{$sum:"$quantity"},totalUzunligi:{$sum:{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[1,{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:[1,"$uzunligi"]}}}},minUzunligi:{$min:"$uzunligi"},maxUzunligi:{$max:"$uzunligi"}}},{$project:{_id:0,name:"$_id.name",qalinligi:"$_id.qalinligi",qalinligi_ortasi:"$_id.qalinligi_ortasi",category:"$_id.category",holati:"$_id.holati",sklad:"$_id.sklad",olchamlari:"$_id.olchamlari",saledPrice:"$_id.saledPrice",quantity:"$totalQuantity",totalUzunligi:"$totalUzunligi",minUzunligi:"$minUzunligi",maxUzunligi:"$maxUzunligi"}},{$sort:{category:1,qalinligi:1,qalinligi_ortasi:1,quantity:1}}]);return await g.populate(n,{path:"sklad"}),e.status(200).json(n)}catch(t){return console.log(t),e.status(500).json(t)}},e.skladExcelGet=async(t,e)=>{try{const a={font:{bold:!0},alignment:{horizontal:"center",vertical:"middle"},border:{top:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"}}},s=new r.Workbook,i=s.addWorksheet("SKLAD"),n=await g.aggregate([{$match:{sklad:new l.Types.ObjectId(t.params.id),saled:!1}},{$group:{_id:{name:"$name",qalinligi:"$qalinligi",qalinligi_ortasi:"$qalinligi_ortasi",category:"$category",holati:"$holati",uzunligi:"$uzunligi",uzunligi_x:"$uzunligi_x",olchamlari:"$olchamlari",uzunligi_y:"$uzunligi_y",sklad:"$sklad",price:"$price",saledPrice:"$saledPrice"},totalQuantity:{$sum:"$quantity"}}},{$project:{_id:0,name:"$_id.name",qalinligi:"$_id.qalinligi",qalinligi_ortasi:"$_id.qalinligi_ortasi",category:"$_id.category",holati:"$_id.holati",uzunligi:"$_id.uzunligi",uzunligi_x:"$_id.uzunligi_x",uzunligi_y:"$_id.uzunligi_y",sklad:"$_id.sklad",price:"$_id.price",olchamlari:"$_id.olchamlari",saledPrice:"$_id.saledPrice",quantity:"$totalQuantity"}}]);return i.getCell(1,1).value="Mahsulot Nomi",i.getCell(1,2).value="O'lchamlari",i.getCell(1,3).value="Kategoriyasi",i.getCell(1,4).value="Holati",i.getCell(1,5).value="Qalinligi",i.getCell(1,6).value="O'lchamlari",i.getCell(1,7).value="Uzunligi",i.getCell(1,8).value="Soni",i.getCell(1,9).value="Umumiy Uzunligi",i.getCell(1,10).value="1 m Uchun Narx",n.forEach(((t,e)=>{i.getCell(e+2,1).value=t.name,i.getCell(e+2,2).value=t.olchamlari||"",i.getCell(e+2,3).value=t.category,i.getCell(e+2,4).value=t.holati,i.getCell(e+2,5).value=t.qalinligi_ortasi?`O'rtasi: ${t.qalinligi_ortasi}mm Chet:${t.qalinligi}mm`:`${t.qalinligi}mm`,i.getCell(e+2,6).value=t.uzunligi_y||t.uzunligi_x?`${t.uzunligi_y}mm ${t.uzunligi_x}mm`:"",i.getCell(e+2,7).value=`${t.uzunligi?t.uzunligi:0}m`,i.getCell(e+2,8).value=`${t.quantity?t.quantity:0}ta`,i.getCell(e+2,9).value=t.quantity*t.uzunligi+"m",i.getCell(e+2,10).value=t.saledPrice?`${t.saledPrice}so'm`:"Narx Belgilanmagan"})),i.columns.forEach((t=>{let e=0;t.eachCell({includeEmpty:!0},(t=>{const a=t.value?t.value.toString().length:10;a>e&&(e=a+3)})),t.width=e<10?10:e})),i.eachRow((t=>{t.eachCell((t=>{t.style=a}))})),await s.xlsx.writeFile("./docs/HISOBOT.xlsx"),e.download("./docs/HISOBOT.xlsx")}catch(t){return e.status(500).json(t)}},e.skladPriceGet=async(t,e)=>{try{const t=await g.aggregate([{$match:{saled:!1}},{$group:{_id:null,totalPrice:{$sum:{$cond:{if:{$eq:["$name","List"]},then:{$multiply:["$price",{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:["$price","$uzunligi"]}}}}}},{$project:{_id:0,totalAmount:"$totalPrice"}}]),a=t.length>0?t[0].totalAmount:0;return e.json({result:a})}catch(t){return e.status(500).json(t)}},e.clientsGet=async(t,e)=>{try{const t=await $.find();return e.json(t)}catch(t){return e.status(500).json(t)}},e.clientsGetById=async(t,e)=>{try{const a=await $.findById(t.params.id);return e.json(a)}catch(t){return e.status(500).json(t)}},e.clientsPut=async(t,e)=>{try{const a=new $({name:t.body.name,phone:t.body.phone});return await a.save(),e.json(a)}catch(t){return e.status(500).json(t)}},e.clientsDelete=async(t,e)=>{try{return await $.findByIdAndDelete(t.params.id),e.json({message:"Client deleted"})}catch(t){return e.status(500).json(t)}},e.clientsPost=async(t,e)=>{try{const a=await $.findById(t.params.id);return a.name=t.body.name,a.phone=t.body.phone,await a.save(),e.json(a)}catch(t){return e.status(500).json(t)}};const b=async(t,e,a,s)=>{const i={...t};delete i._id;for(let n=0;n<t.quantity;n++){delete i.quantity;let n=new Date;n=o(n).format(),await g.findOneAndUpdate(i,{$set:{saled:!0,saledPrice:t.saledPrice,saledClient:new l.Types.ObjectId(e),saledType:a,saledDate:n,saledSeller:new l.Types.ObjectId(s)}})}};e.sellPost=async(t,e)=>{try{const{client:a,seller:s,products:i,saledType:n,total:r}=t.body;for(const t of i)t.saled=!1,t.sklad=new l.Types.ObjectId(t.sklad),await b(t,a._id,n,s._id);if("Qarz"!==n){const t=new m({clientId:new l.Types.ObjectId(a._id),sellerId:new l.Types.ObjectId(s._id),products:i,allAmount:r,type:n});await t.save()}else{const t=new p({sellerId:new l.Types.ObjectId(s._id),clientId:new l.Types.ObjectId(a._id),products:i,allAmount:r});await t.save()}return e.json({saved:!0})}catch(t){return e.status(500).json(t)}},e.sellerGet=async(t,e)=>{try{const t=await h.find({active:!0});return e.json(t)}catch(t){return e.status(500).json(t)}},e.getSellerById=async(t,e)=>{try{const a=await h.findById(t.params.id);return e.json(a)}catch(t){return e.status(500).json(t)}},e.sellerPut=async(t,e)=>{try{const a=new h({name:t.body.name,phone:t.body.phone});return await a.save(),e.json(a)}catch(t){return e.status(500).json(t)}},e.sellerDelete=async(t,e)=>{try{const a=await h.findById(t.params.id);return a.active=!1,await a.save(),e.json({message:"Seller deleted"})}catch(t){return e.status(500).json(t)}},e.sellerPost=async(t,e)=>{try{const a=await h.findById(t.params.id);return a.name=t.body.name,a.phone=t.body.phone,await a.save(),e.json(a)}catch(t){return e.status(500).json(t)}},e.getSellerResults=async(t,e)=>{try{const a=new Date;a.setDate(a.getDate()-7);const s=t.body.startDate?new Date(t.body.startDate):a,i=t.body.endDate?new Date(t.body.endDate):new Date,n=await g.aggregate([{$match:{saledSeller:new l.Types.ObjectId(t.params.id),saled:!0,saledDate:{$exists:!0,$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$saledDate"},month:{$month:"$saledDate"},day:{$dayOfMonth:"$saledDate"}},totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[{$subtract:["$saledPrice","$price"]},{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:[{$subtract:["$saledPrice","$price"]},"$uzunligi"]}}},1]}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]),r=await g.aggregate([{$match:{saledSeller:new l.Types.ObjectId(t.params.id),saled:!0,saledDate:{$exists:!0,$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$saledDate"},month:{$month:"$saledDate"},day:{$dayOfMonth:"$saledDate"}},totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:["$price",{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:["$price","$uzunligi"]}}}]}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]),o=await g.aggregate([{$match:{sellerId:new l.Types.ObjectId(t.params.id),date:{$exists:!0,$type:"date",$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$date"},month:{$month:"$date"},day:{$dayOfMonth:"$date"}},totalAmount:{$sum:{$cond:{if:{$eq:["$name","List"]},then:{$multiply:["$price",{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:["$price","$uzunligi"]}}}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]);return e.json({sales:n,came:o,sof:r})}catch(t){return e.status(500).json(t)}},e.cutPost=async(t,e)=>{try{const a=await g.findOne(t.body.product);a.cut=!0,a.uzunligi=parseFloat(t.body.cut),await a.save();const s=new g(t.body.product);return s.cut=!0,s.uzunligi=(parseFloat(s.uzunligi)-parseFloat(t.body.cut)).toFixed(2),s.quantity=1,await s.save(),e.json({cutted:!0})}catch(t){return e.status(500).json(t)}},e.getSellerProducts=async(t,e)=>{try{const a=new Date;a.setDate(a.getDay()-31);const s=t.body.startDate||a,i=t.body.endDate||new Date,n=await m.find({sellerId:new l.Types.ObjectId(t.params.id),date:{$gte:s,$lte:i}}).sort({date:-1}).populate("clientId").populate("sellerId").limit(50),r=await p.find({sellerId:t.params.id,date:{$gte:s,$lte:i}}).sort({_id:-1}).populate("sellerId").populate("clientId").limit(50);return e.json({products:n,debts:r})}catch(t){return e.status(500).json(t)}},e.noticesGet=async(t,e)=>{try{const t=await j.find().populate("senderName").sort({createdAt:-1});return e.json(t)}catch(t){return e.status(500).json(t)}},e.noticesPut=async(t,e)=>{try{const a=new j({senderName:new l.Types.ObjectId(t.userId),text:t.body.text});return await a.save(),e.status(200).json({status:"success"})}catch(t){return e.status(500).json(t)}},e.productsYearGet=async(t,e)=>{try{const t=(new Date).getFullYear(),a=await g.aggregate([{$match:{saled:!0,saledDate:{$gte:new Date(`${t}-01-01T00:00:00.000Z`),$lte:new Date(`${t+1}-01-01T00:00:00.000Z`)}}},{$project:{totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[{$subtract:["$saledPrice","$price"]},{$cond:{if:{$ne:["$uzunligi_x",0]},then:{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]},else:0}}]},else:{$multiply:[{$subtract:["$saledPrice","$price"]},"$uzunligi"]}}},1]}}}},{$group:{_id:null,totalAmount:{$sum:"$totalAmount"}}}]),s=a.length>0?a[0].totalAmount:0;return e.json({totalAmount:s})}catch(t){return e.status(500).json(t)}},e.productsYearGetGraph=async(t,e)=>{try{const t=(new Date).getFullYear(),a=await g.aggregate([{$match:{saled:!0,saledDate:{$gte:new Date(`${t}-01-01T00:00:00.000Z`),$lte:new Date(`${t+1}-01-01T00:00:00.000Z`)}}},{$group:{_id:{year:{$year:"$saledDate"},month:{$month:"$saledDate"},day:{$dayOfMonth:"$saledDate"}},totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[{$subtract:["$saledPrice","$price"]},{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:[{$subtract:["$saledPrice","$price"]},"$uzunligi"]}}},1]}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]);return e.json(a)}catch(t){return e.status(500).json(t)}},e.hisobotGet=async(t,e)=>{try{const a=new Date;a.setDate(a.getDate()-7);const s=t.body.startDate?new Date(t.body.startDate):a,i=t.body.endDate?new Date(t.body.endDate):new Date,n=await d.aggregate([{$match:{date:{$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$date"},month:{$month:"$date"},day:{$dayOfMonth:"$date"}},totalAmount:{$sum:"$amount"},totalRecords:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]),l=await g.aggregate([{$match:{saled:!0,saledDate:{$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$saledDate"},month:{$month:"$saledDate"},day:{$dayOfMonth:"$saledDate"}},totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:[{$subtract:["$saledPrice","$price"]},{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:[{$subtract:["$saledPrice","$price"]},"$uzunligi"]}}},1]}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]),r=await g.aggregate([{$match:{saled:!0,saledDate:{$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$saledDate"},month:{$month:"$saledDate"},day:{$dayOfMonth:"$saledDate"}},totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:["$saledPrice",{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:["$saledPrice","$uzunligi"]}}}]}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]),o=await g.aggregate([{$match:{date:{$gte:s,$lte:i}}},{$group:{_id:{year:{$year:"$date"},month:{$month:"$date"},day:{$dayOfMonth:"$date"}},totalAmount:{$sum:{$multiply:[{$cond:{if:{$eq:["$name","List"]},then:{$multiply:["$price",{$divide:[{$multiply:["$uzunligi_x","$uzunligi_y"]},1e4]}]},else:{$multiply:["$price","$uzunligi"]}}}]}},totalProducts:{$sum:1}}},{$sort:{"_id.year":1,"_id.month":1,"_id.day":1}}]),u=new Map;l.forEach((t=>{const{year:e,month:a,day:s}=t._id,i=`${e}-${a}-${s}`,n=(u.get(i)||0)+t.totalAmount;u.set(i,n)})),n.forEach((t=>{const{year:e,month:a,day:s}=t._id,i=`${e}-${a}-${s}`,n=(u.get(i)||0)-t.totalAmount;u.set(i,n)}));const c=Array.from(u,(([t,e])=>({_id:{day:new Date(t).getDate(),month:new Date(t).getMonth()+1,year:new Date(t).getFullYear()},totalAmount:e})));return c.sort(((t,e)=>1e4*t._id.year+100*t._id.month+t._id.day-(1e4*e._id.year+100*e._id.month+e._id.day))),e.json({harajat:n,foyda:l,savdoTushumi:r,sofFoyda:c,kirimTushumi:o})}catch(t){return e.status(500).json(t)}},e.phoneGet=async(t,e)=>{try{const t=(()=>{try{const t=w.readFileSync("./db/phone.json","utf8");return JSON.parse(t)}catch(t){return console.error("Error reading JSON file:",t),{}}})();return e.json(t)}catch(t){return e.status(500).json(t)}},e.phonePost=async(t,e)=>{try{const a=t.body;return w.writeFileSync("./db/phone.json",JSON.stringify(a)),e.json({...a,status:"success"})}catch(t){return e.status(500).json(t)}}},406:(t,e)=>{e.formatTime=t=>{const e=new Date(t);return`${e.getDate().toString().padStart(2,"0")}.${(e.getMonth()+1).toString().padStart(2,"0")}.${e.getFullYear()} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}`}},10:(t,e,a)=>{const s=a(860),i=a(185),n=a(582),l=a(17),r=a(147);a(142).config();const o=a(194),u=a(182),d=s();d.use(n()),d.use(s.json()),d.use("/api",o),d.use("/api/user2",u);const c=l.join(__dirname,"log"),y=()=>{const t=new Date,e=`${String(t.getDate()).padStart(2,"0")}-${String(t.getMonth()+1).padStart(2,"0")}-${t.getFullYear()}`;return l.join(c,`${e}.mongodb.log`)};r.mkdirSync(c,{recursive:!0});let g=r.createWriteStream(y(),{flags:"a"});i.set("debug",((t,e,a,s)=>{const i=`[${(new Date).toISOString()}] ${t}.${e} ${JSON.stringify(a)} ${JSON.stringify(s)}\n`;g.path!==y()&&(g.end(),g=r.createWriteStream(y(),{flags:"a"})),g.write(i)})),i.connect(process.env.MONGODB_URI).then((()=>{console.log("Server is connecting on MongoDB");const t=process.env.PORT||3002;d.listen(t,(()=>{console.log(`Server is running on ${process.env.PROTOCOL}://${process.env.SERVER_IP}:${t}`)}))})).catch((t=>{console.error("Error connecting to the database:",t)})),t.exports=d},946:(t,e,a)=>{const s=a(344),i=a(901);a(142).config(),t.exports=async function(t,e,a){const n=t.headers.authorization;if(!n)return e.status(401).json({error:"Not Authorized!",message:"Missing authorization header"});const l=n.split(" ")[1];if(!l)return e.status(401).json({error:"Not Authorized!",message:"Invalid access token"});try{const n=s.verify(l,process.env.ACCESS_TOKEN_SECRET);return t.userId=n.userId,await i.findById(t.userId)?a():e.status(401).json({error:"Not Authorized!",message:"Invalid access token"})}catch(t){return t instanceof s.JsonWebTokenError?e.status(401).json({error:"Not Authorized!",message:"Invalid access token"}):e.status(500).json({error:"Internal Server Error",message:"An error occurred"})}}},133:(t,e,a)=>{const s=a(344),i=a(901);a(142).config(),t.exports=async function(t,e,a){const n=t.headers.authorization;if(!n)return e.status(401).json({error:"Not Authorized!",message:"Missing authorization header"});const l=n.split(" ")[1];if(!l)return e.status(401).json({error:"Not Authorized!",message:"Invalid access token"});try{const n=s.verify(l,process.env.ACCESS_TOKEN_SECRET);t.userId=n.userId;const r=await i.findById(t.userId);return r?2!==r.user_level?e.status(400).json({message:"You are not admin"}):a():e.status(401).json({error:"Not Authorized!",message:"Invalid access token"})}catch(t){return t instanceof s.JsonWebTokenError?e.status(401).json({error:"Not Authorized!",message:"Invalid access token"}):e.status(500).json({error:"Internal Server Error",message:"An error occurred"})}}},380:(t,e,a)=>{const s=a(344),i=a(901);a(142).config(),t.exports=async function(t,e,a){const n=t.headers.authorization;if(!n)return e.status(401).json({error:"Not Authorized!",message:"Missing authorization header"});const l=n.split(" ")[1];if(!l)return e.status(401).json({error:"Not Authorized!",message:"Invalid access token"});try{const n=s.verify(l,process.env.ACCESS_TOKEN_SECRET);t.userId=n.userId;const r=await i.findById(t.userId);return r?1!==r.user_level?e.status(400).json({message:"You are not admin"}):a():e.status(401).json({error:"Not Authorized!",message:"Invalid access token"})}catch(t){return t instanceof s.JsonWebTokenError?e.status(401).json({error:"Not Authorized!",message:"Invalid access token"}):e.status(500).json({error:"Internal Server Error",message:"An error occurred"})}}},986:(t,e,a)=>{const s=a(185),i=new s.Schema({senderName:{type:s.Schema.Types.ObjectId,ref:"users"},text:{type:String},viewUsers:{type:Array}});i.set("timestamps",!0);const n=s.model("alerts",i);t.exports=n},329:(t,e,a)=>{const s=a(185),i=new s.Schema({name:{type:String},phone:{type:String},date:{type:Date,default:Date.now}});i.set("timestamps",!0);const n=s.model("client",i);t.exports=n},566:(t,e,a)=>{const s=a(185),i=new s.Schema({clientId:{type:s.Schema.Types.ObjectId,ref:"client"},sellerId:{type:s.Schema.Types.ObjectId,ref:"seller"},products:{type:Array},allAmount:{type:Number},payedAmount:{type:Number,default:0},historyAmount:{type:Array,default:[]},date:{type:Date,default:Date.now},active:{type:Boolean,default:!0}});i.set("timestamps",!0);const n=s.model("debts",i);t.exports=n},847:(t,e,a)=>{const s=a(185),i=new s.Schema({name:{type:String},amount:{type:Number},userId:{type:s.Schema.Types.ObjectId,ref:"users"},sklad:{type:s.Schema.Types.ObjectId,ref:"sklad"},date:{type:Date,default:Date.now}});i.set("timestamps",!0);const n=s.model("harajat",i);t.exports=n},877:(t,e,a)=>{const s=a(185),i=new s.Schema({user:{type:s.Schema.Types.ObjectId,ref:"users"},deletedFrom:{name:{type:String},amount:{type:Number}}});i.set("timestamps",!0);const n=s.model("harajatHistoryDeleted",i);t.exports=n},337:(t,e,a)=>{const s=a(185),i=new s.Schema({user:{type:s.Schema.Types.ObjectId,ref:"users"},editedID:{type:s.Schema.Types.ObjectId,ref:"harajat"},editedFrom:{name:{type:String},amount:{type:Number}}});i.set("timestamps",!0);const n=s.model("harajatHistoryEdited",i);t.exports=n},404:(t,e,a)=>{const s=a(185),i=new s.Schema({userId:{type:s.Schema.Types.ObjectId,ref:"users"},name:{type:String},sellerId:{type:s.Schema.Types.ObjectId,ref:"seller"},qalinligi:{type:Number},qalinligi_ortasi:{type:Number,default:0},olchamlari:{type:String,default:""},category:{type:String},holati:{type:String},uzunligi:{type:Number},uzunligi_y:{type:Number,default:0},uzunligi_x:{type:Number,default:0},quantity:{type:Number},sklad:{type:s.Schema.Types.ObjectId,ref:"sklad"},price:{type:Number},saledPrice:{type:Number},saledSeller:{type:s.Schema.Types.ObjectId,ref:"seller"},saledClient:{type:s.Schema.Types.ObjectId,ref:"client"},saledType:{type:String},saledDate:{type:Date},saled:{type:Boolean,default:!1},cut:{type:Boolean,default:!1},date:{type:Date,default:Date.now},isDebt:{type:Boolean,default:!1}});i.set("timestamps",!0);const n=s.model("products",i);t.exports=n},465:(t,e,a)=>{const s=a(185),i=new s.Schema({clientId:{type:s.Schema.Types.ObjectId,ref:"client"},sellerId:{type:s.Schema.Types.ObjectId,ref:"seller"},products:{type:Array},allAmount:{type:Number},type:{type:String},date:{type:Date,default:Date.now},debt:{type:Array,default:[]}});i.set("timestamps",!0);const n=s.model("saled",i);t.exports=n},206:(t,e,a)=>{const s=a(185),i=new s.Schema({name:{type:String},phone:{type:String},active:{type:Boolean,default:!0},date:{type:Date,default:Date.now}});i.set("timestamps",!0);const n=s.model("seller",i);t.exports=n},272:(t,e,a)=>{const s=a(185),i=new s.Schema({name:{type:String},date:{type:Date,default:Date.now},active:{type:Boolean,default:!0}});i.set("timestamps",!0);const n=s.model("sklad",i);t.exports=n},901:(t,e,a)=>{const s=a(185),i=new s.Schema({login:{type:String},password:{type:String},user_level:{type:Number},name:{type:String},surname:{type:String}});i.set("timestamps",!0);const n=s.model("users",i);t.exports=n},194:(t,e,a)=>{const s=a(860),i=a(53),n=a(380),l=a(946),r=s.Router();r.get("/",i.index),r.get("/token",i.token),r.post("/register",i.register),r.post("/login",i.login),r.patch("/login",n,i.loginPatch),r.get("/check",n,i.check),r.get("/user",l,i.userGetInfo),r.get("/users",n,i.usersGetAll),r.delete("/user/:id",n,i.userDelete),r.patch("/user/:id",n,i.userPatch),r.put("/harajat",n,i.harajatPut),r.get("/harajat",n,i.harajatGet),r.delete("/harajat/:id",n,i.harajatDelete),r.patch("/harajat/:id",n,i.harajatPatch),r.post("/harajat/find",n,i.harajatFinder),r.get("/harajat/excel",n,i.harajatExcel),r.get("/harajat/excel-by-date",n,i.harajatExcelByDate),r.get("/harajat/year",n,i.harajatYearGet),r.get("/harajat/graph",n,i.harajatYearGetGraph),r.get("/sklad",n,i.skladGet),r.post("/sklad/products",n,i.skladProductsPost),r.patch("/sklad",n,i.skladPatchPrice),r.get("/sklads",n,i.skladsGet),r.put("/sklad",n,i.skladPut),r.delete("/sklad/:id",n,i.skladDelete),r.patch("/sklad/:id",n,i.skladPatch),r.post("/sklad/find",n,i.skladFinder),r.get("/sklad/:id/excel",n,i.skladExcelGet),r.get("/sklad/price",n,i.skladPriceGet),r.get("/products/:id",n,i.productsGet),r.patch("/products/:id",n,i.productsPatch),r.get("/products",n,i.productsGetAll),r.put("/products",n,i.productsPut),r.post("/products/find",n,i.productsFinder),r.post("/products/:id",n,i.productsGetClients),r.post("/products/client/:id",n,i.productsGetClientsByDate),r.get("/products/saled",n,i.productsGetSaled),r.post("/productId",n,i.getProductId),r.put("/product",n,i.productPut),r.post("/products/:id/debts",n,i.getProductsWithDebts),r.post("/products/info/:id",n,i.postProductsInfo),r.post("/products/debt/:id",n,i.postProductsDebt),r.put("/products/debt/:id",n,i.putProductsDebt),r.get("/products/seller/:id",n,i.productsGetSeller),r.post("/products/seller/:id",n,i.productsPostSeller),r.get("/products/debts/price",n,i.getProductsWithDebtsPrice),r.get("/clients",n,i.clientsGet),r.get("/client/:id",n,i.clientsGetById),r.put("/clients",n,i.clientsPut),r.delete("/client/:id",n,i.clientsDelete),r.post("/client/:id",n,i.clientsPost),r.post("/sell",n,i.sellPost),r.get("/sellers",n,i.sellerGet),r.get("/seller/:id",n,i.getSellerById),r.put("/sellers",n,i.sellerPut),r.delete("/sellers/:id",n,i.sellerDelete),r.post("/sellers/:id",n,i.sellerPost),r.post("/seller/:id/results",n,i.getSellerResults),r.post("/seller/:id/products",n,i.getSellerProducts),r.post("/cut",n,i.cutPost),r.get("/notices",i.noticesGet),r.put("/notices",n,i.noticesPut),r.get("/productsYear",n,i.productsYearGet),r.get("/productsYear/graph",n,i.productsYearGetGraph),r.post("/hisobot",n,i.hisobotGet),r.get("/phone",n,i.phoneGet),r.post("/phone",n,i.phonePost),t.exports=r},182:(t,e,a)=>{const s=a(860),i=a(53),n=a(133),l=a(946),r=s.Router();r.patch("/login",n,i.loginPatch),r.get("/user",l,i.userGetInfo),r.get("/sklad",n,i.skladGet),r.get("/sklad/:id/excel",n,i.skladExcelGet),r.get("/products/:id",n,i.productsGet),t.exports=r},96:t=>{"use strict";t.exports=require("bcrypt")},582:t=>{"use strict";t.exports=require("cors")},142:t=>{"use strict";t.exports=require("dotenv")},641:t=>{"use strict";t.exports=require("exceljs")},860:t=>{"use strict";t.exports=require("express")},344:t=>{"use strict";t.exports=require("jsonwebtoken")},245:t=>{"use strict";t.exports=require("moment")},185:t=>{"use strict";t.exports=require("mongoose")},414:t=>{"use strict";t.exports=require("unique-username-generator")},147:t=>{"use strict";t.exports=require("fs")},17:t=>{"use strict";t.exports=require("path")}},e={};!function a(s){var i=e[s];if(void 0!==i)return i.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,a),n.exports}(10)})();